name: Keep Render API Awake üöÄ

on:
  schedule:
    - cron: '*/5 * * * *'  # every 5 minutes (UTC time)
  workflow_dispatch:  # allows manual run

jobs:
  ping:
    runs-on: ubuntu-latest
    steps:
      - name: Ping Render API
        run: |
          echo "Pinging API at $(date -u)"
          URL="https://movies-backend-hazel.vercel.app/"
          HTTP_STATUS=$(curl -s -o /dev/null -w "%{http_code}" $URL)
          echo "HTTP Status: $HTTP_STATUS"

          if [ "$HTTP_STATUS" != "200" ] && [ "$HTTP_STATUS" != "204" ]; then
            echo "‚ö†Ô∏è API responded with non-200 code ($HTTP_STATUS)"
          else
            echo "‚úÖ API is awake and responding fine!"
          fi

      - name: Ping Dashboard API
        run: |
          echo "Pinging Dashboard API at $(date -u)"
          DASHBOARD_URL="https://dashboard-4zxv.onrender.com/"
          DASHBOARD_STATUS=$(curl -s -o /dev/null -w "%{http_code}" $DASHBOARD_URL)
          echo "HTTP Status: $DASHBOARD_STATUS"

          if [ "$DASHBOARD_STATUS" != "200" ] && [ "$DASHBOARD_STATUS" != "204" ]; then
            echo "‚ö†Ô∏è Dashboard API responded with non-200 code ($DASHBOARD_STATUS)"
          else
            echo "‚úÖ Dashboard API is awake and responding fine!"
          fi
